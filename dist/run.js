!function(){metadata={systemName:"MSExcelTodoJSSP",displayName:"Microsoft Excel and To Do",description:"A connector for Microsoft Excel and To Do"};const e="https://graph.microsoft.com/v1.0";function i(e,i,t,l){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(console.log("ExecuteRequest XHR status: "+s.status+","+s.responseText),4===s.readyState)if(201==s.status){try{e=JSON.parse(s.responseText)}catch(e){}"function"==typeof l&&l(e)}else if(204==s.status)"function"==typeof l&&l(s.responseText);else if(200==s.status){var e=JSON.parse(s.responseText);"function"==typeof l&&l(e)}else if(202==s.status)"function"==typeof l&&l(null);else{if(400==s.status){e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if(404!=s.status){postResult({});e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if("No Team found with Group id"!=(e=JSON.parse(s.responseText)).error.message.startswith)throw new Error(e.error.code+": "+e.error.message)}},console.log("MSTeamsConnector ExecuteRequest: "+e),s.open(t.toUpperCase(),e),s.withCredentials=!0,s.setRequestHeader("Accept","application/json"),"PUT"!=t.toUpperCase()&&"POST"!=t.toUpperCase()&&"PATCH"!=t.toUpperCase()||s.setRequestHeader("Content-Type","application/json"),s.send(i)}function t(e,i){global[e]=i}ondescribe=function(){postSchema({objects:{drive:{displayName:"Drive",description:"Drive",properties:{fileId:{displayName:"File ID",description:"File ID",type:"string"},fileWebUrl:{displayName:"File Web URL",description:"File Web URL",type:"string"},fileSize:{displayName:"File Size",description:"File Size",type:"number"},fileName:{displayName:"File Name",description:"File Name",type:"string"},fileCreatedDate:{displayName:"File Created Date",description:"File Created Date",type:"dateTime"},fileCreatedBy:{displayName:"File Created By",description:"File Created By",type:"string"},fileCreatedByEmail:{displayName:"File Created By Email",description:"File Created By Email",type:"string"},fileMimeType:{displayName:"File Mime Type",description:"File Mime Type",type:"string"},filePath:{displayName:"File Path",description:"File Path",type:"string"},folderName:{displayName:"Folder Name",description:"Folder Name",type:"string"},folderPath:{displayName:"Folder Path",description:"Folder Path",type:"string"}},methods:{searchFile:{displayName:"Search for a file in my OneDrive",type:"read",inputs:["fileName","filePath"],requiredInputs:["fileName"],outputs:["fileId","fileWebUrl","fileSize","fileName","fileCreatedDate","fileCreatedBy","fileCreatedByEmail","fileMimeType"]},createFolder:{displayName:"Create Folder",type:"execute",inputs:["folderName","folderPath"],requiredInputs:["folderName"],outputs:[]}}},excel:{displayName:"Excel",description:"Excel",properties:{fileId:{displayName:"File ID",description:"File ID",type:"string"},sheetName:{displayName:"Sheet Name",description:"Sheet Name",type:"string"},column1:{displayName:"Column 1",description:"Column 1",type:"string"},column2:{displayName:"Column 2",description:"Column 2",type:"string"},column3:{displayName:"Column 3",description:"Column 3",type:"string"},column4:{displayName:"Column 4",description:"Column 4",type:"string"},column5:{displayName:"Column 5",description:"Column 5",type:"string"},column6:{displayName:"Column 6",description:"Column 6",type:"string"},column7:{displayName:"Column 7",description:"Column 7",type:"string"},column8:{displayName:"Column 8",description:"Column 8",type:"string"},column9:{displayName:"Column 9",description:"Column 9",type:"string"},column10:{displayName:"Column 10",description:"Column 10",type:"string"},column11:{displayName:"Column 11",description:"Column 11",type:"string"},column12:{displayName:"Column 12",description:"Column 12",type:"string"},column13:{displayName:"Column 13",description:"Column 13",type:"string"},column14:{displayName:"Column 14",description:"Column 14",type:"string"},column15:{displayName:"Column 15",description:"Column 15",type:"string"},column16:{displayName:"Column 16",description:"Column 16",type:"string"},column17:{displayName:"Column 17",description:"Column 17",type:"string"},column18:{displayName:"Column 18",description:"Column 18",type:"string"},column19:{displayName:"Column 19",description:"Column 19",type:"string"},column20:{displayName:"Column 20",description:"Column 20",type:"string"}},methods:{getUsedRangeItems:{displayName:"Get Worksheet Rows in Used Range",type:"list",inputs:["fileId","sheetName"],requiredInputs:["fileId","sheetName"],outputs:[]}}}}})},onexecute=function({objectName:t,methodName:l,parameters:s,properties:o}){switch(t){case"drive":!function(t,l,s){switch(t){case"searchFile":!function(e,t){!function(e,t,l){let s=t.fileName,o=t.filePath;if("string"!=typeof s)throw new Error("properties[FileName] is not of type string");var r;r="string"==typeof o&&""!=o?`https://graph.microsoft.com/v1.0/me/drive/root:/${o}:/search(q='${s}')`:`https://graph.microsoft.com/v1.0/me/drive/root/search(q='${s}')`;i(r,null,"GET",(function(e){"function"==typeof l&&l(e)}))}(0,t,(function(e){var i={fileId:"",fileWebUrl:"",fileSize:0,fileName:"",fileCreatedDate:null,fileCreatedBy:"",fileCreatedByEmail:"",fileMimeType:""};e.value.length>0&&(i.fileId=e.value[0].id,i.fileWebUrl=e.value[0].webUrl,i.fileSize=e.value[0].size,i.fileName=e.value[0].name,i.fileCreatedDate=Date.parse(e.value[0].createdDateTime),i.fileCreatedBy=e.value[0].createdBy.user.displayName,i.fileCreatedByEmail=e.value[0].createdBy.user.email,i.fileMimeType=e.value[0].file.mimeType),postResult(i)}))}(0,s);break;case"createFolder":!function(t,l){!function(t,l,s){let o=l.folderName,r=l.folderPath;if("string"!=typeof o)throw new Error("properties[FolderName] is not of type string");var n;n="string"==typeof r&&""!=r?`https://graph.microsoft.com/v1.0/me/drive/root:/${r}:/children'`:e+"/me/drive/root/children";var a={name:o,folder:{},"@microsoft.graph.conflictBehavior":"replace"};i(n,JSON.stringify(a),"POST",(function(){"function"==typeof s&&s()}))}(0,l,(function(){}))}(0,s);break;default:throw new Error("The method "+t+" is not supported..")}}(l,0,o);break;case"excel":!function(e,t,l){switch(e){case"getUsedRangeItems":!function(e,t){!function(e,t,l){let s=t.fileId,o=t.sheetName;if("string"!=typeof s)throw new Error("properties[FileId] is not of type string");if("string"!=typeof o)throw new Error("properties[ExcelSheetName] is not of type string");i(`https://graph.microsoft.com/v1.0/me/drive/items/${s}/workbook/worksheets('${o}')/usedRange`,null,"GET",(function(e){"function"==typeof l&&l(e)}))}(0,t,(function(e){var i=e.text.map(e=>{for(var i={},t=0;t<e.length;t++)t+1<21&&(i["Column"+(t+1)]=e[t]);return i});postResult(i)}))}(0,l);break;default:throw new Error("The method "+e+" is not supported..")}}(l,0,o);break;default:throw new Error("The object "+t+" is not supported.")}};let l=null;t("postSchema",(function(e){l=e,console.log("postSchema:"),console.log(l)})),t("postResult",(function(e){}));t("XMLHttpRequest",class{constructor(){this.recorder={},this.recorder.headers={}}open(e,i){this.recorder.opened={method:e,url:i}}setRequestHeader(e,i){this.recorder.headers[e]=i}send(e){const i=require("request");this.withCredentials&&this.setRequestHeader("Authorization","Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6IjU3UDIzTms5bWQwVVpaVzJKNGFxS2xJcEpGMDR0YjhUdFg5bzJtTjFEZ1EiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mMGNkM2U0ZC00NDAyLTQ5NDAtODQyYi03ZjRjZGU2YjRjM2YvIiwiaWF0IjoxNjIxMjU0Mjk3LCJuYmYiOjE2MjEyNTQyOTcsImV4cCI6MTYyMTM0MDk5NiwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVNRQTIvOFRBQUFBSUpNck1hWVhudlJ1UEpQNjl1VkxGeXlpNEtLZ2RrZE9xTTNQQ244bTdvdz0iLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIGV4cGxvcmVyIChvZmZpY2lhbCBzaXRlKSIsImFwcGlkIjoiZGU4YmM4YjUtZDlmOS00OGIxLWE4YWQtYjc0OGRhNzI1MDY0IiwiYXBwaWRhY3IiOiIwIiwiZmFtaWx5X25hbWUiOiJIYXl0ZXIiLCJnaXZlbl9uYW1lIjoiRXJuaWUiLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiI4Mi4xMi4xNTYuMTg0IiwibmFtZSI6IkVybmllIEhheXRlciIsIm9pZCI6IjlkMzgyNGI1LThkNDItNDU4YS04Mjc1LTdhNjAwMzdhZDkyNSIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMjAwMEEyMjY0NDREIiwicmgiOiIwLkFSQUFUVDdOOEFKRVFFbUVLMzlNM210TVA3WElpOTc1MmJGSXFLMjNTTnB5VUdRUUFKSS4iLCJzY3AiOiJDYWxlbmRhcnMuUmVhZFdyaXRlIENoYW5uZWxNZW1iZXIuUmVhZC5BbGwgQ2hhbm5lbE1lbWJlci5SZWFkV3JpdGUuQWxsIENoYW5uZWxNZXNzYWdlLlJlYWQuQWxsIENoYW5uZWxNZXNzYWdlLlNlbmQgQ29udGFjdHMuUmVhZFdyaXRlIERldmljZU1hbmFnZW1lbnRBcHBzLlJlYWRXcml0ZS5BbGwgRGV2aWNlTWFuYWdlbWVudENvbmZpZ3VyYXRpb24uUmVhZC5BbGwgRGV2aWNlTWFuYWdlbWVudENvbmZpZ3VyYXRpb24uUmVhZFdyaXRlLkFsbCBEZXZpY2VNYW5hZ2VtZW50TWFuYWdlZERldmljZXMuUHJpdmlsZWdlZE9wZXJhdGlvbnMuQWxsIERldmljZU1hbmFnZW1lbnRNYW5hZ2VkRGV2aWNlcy5SZWFkLkFsbCBEZXZpY2VNYW5hZ2VtZW50TWFuYWdlZERldmljZXMuUmVhZFdyaXRlLkFsbCBEZXZpY2VNYW5hZ2VtZW50UkJBQy5SZWFkLkFsbCBEZXZpY2VNYW5hZ2VtZW50UkJBQy5SZWFkV3JpdGUuQWxsIERldmljZU1hbmFnZW1lbnRTZXJ2aWNlQ29uZmlnLlJlYWQuQWxsIERldmljZU1hbmFnZW1lbnRTZXJ2aWNlQ29uZmlnLlJlYWRXcml0ZS5BbGwgRGlyZWN0b3J5LkFjY2Vzc0FzVXNlci5BbGwgRGlyZWN0b3J5LlJlYWRXcml0ZS5BbGwgRmlsZXMuUmVhZFdyaXRlLkFsbCBHcm91cC5SZWFkLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5Umlza0V2ZW50LlJlYWQuQWxsIE1haWwuUmVhZFdyaXRlIE1haWxib3hTZXR0aW5ncy5SZWFkV3JpdGUgTm90ZXMuUmVhZFdyaXRlLkFsbCBvcGVuaWQgUGVvcGxlLlJlYWQgUG9saWN5LlJlYWRXcml0ZS5BcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb24gcHJvZmlsZSBSZXBvcnRzLlJlYWQuQWxsIFNpdGVzLlJlYWQuQWxsIFNpdGVzLlJlYWRXcml0ZS5BbGwgVGFza3MuUmVhZFdyaXRlIFRlYW1zVGFiLlJlYWRXcml0ZS5BbGwgVGVhbXNUYWIuUmVhZFdyaXRlRm9yVGVhbSBVc2VyLlJlYWQgVXNlci5SZWFkQmFzaWMuQWxsIFVzZXIuUmVhZFdyaXRlIFVzZXIuUmVhZFdyaXRlLkFsbCBlbWFpbCIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6InhZdjU3T1RuaTdsRWs0elpSWnFlM01rdWxJd0tQLVRuLXJpelVSTnBLVXciLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiRVUiLCJ0aWQiOiJmMGNkM2U0ZC00NDAyLTQ5NDAtODQyYi03ZjRjZGU2YjRjM2YiLCJ1bmlxdWVfbmFtZSI6ImVybmllQGRlbmFsbGl4dGVjaGV1Lm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImVybmllQGRlbmFsbGl4dGVjaGV1Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6IklmZFZFVFJyQzBPN1VUS2JrSmRDQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoiOTBhOE5fUTVEQUhOTmVvckt4WEcxZnBSQ2VvWWxsMVR3c0o1UVNPZ3ZGQSJ9LCJ4bXNfdGNkdCI6MTQzMTYzMDMwMX0.FIAMdlURYxpj4ktuk7OiOiOUOLr7BoJ2VnX1o_u_sxo9LfFR_tx_P5CCRAhRwNlwqH1d-Zpv_o3P_Z67l9wyFqk_Lvi9FmTMNv7GVUA8Fr_e2YZbHJD24FQcgKk9_jdVmGGGZy6wO0CmvxR8p5E-tikPnMou4Dc0ndlqKKdnlAyi2kw4uFvchmwqz99_kzNSxztSJxIHgCUjti0nniMz34AaQGZYuVzg6siWJhPUEmYp3ZJVDsaUdEnnUL6GlSZuSEv0YP9-Q2WXGWd7kryyIqYE2552dhab59yn_pXfxnMBZZV6SkuaGJGYyQyX05L_oNt9gPod2nVAajmUGxKJTw");const t={method:this.recorder.opened.method,url:this.recorder.opened.url,headers:this.recorder.headers,body:e,strictSSL:!1};new Promise((e,l)=>{try{i(t,(i,t,l)=>{i?console.error("error inside request:"+i):(this.responseText=l,this.readyState=4,this.status=t.statusCode,this.onreadystatechange(),e(l),delete this.responseText)})}catch(e){console.log("error ouside request "+e),l()}}).catch(e=>{console.log("Promise error:"+e)})}}),onexecute({objectName:"excel",methodName:"getUsedRangeItems",properties:{fileId:"0135B642TVVZFROTARNZGKDJ6Y6WKQTSCT",sheetName:"Sheet1"},parameters:{},configuration:{},schema:{}})}();
//# sourceMappingURL=run.js.map
