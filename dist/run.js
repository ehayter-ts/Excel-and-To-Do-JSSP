!function(){metadata={systemName:"MSExcelTodoJSSP",displayName:"Microsoft Excel and To Do",description:"A connector for Microsoft Excel and To Do"};function e(e,i){global[e]=i}ondescribe=function(){postSchema({objects:{drive:{displayName:"Drive",description:"Drive",properties:{fileId:{displayName:"File ID",description:"File ID",type:"string"},fileWebUrl:{displayName:"File Web URL",description:"File Web URL",type:"string"},fileSize:{displayName:"File Size",description:"File Size",type:"number"},fileName:{displayName:"File Name",description:"File Name",type:"string"},fileCreatedDate:{displayName:"File Created Date",description:"File Created Date",type:"dateTime"},fileCreatedBy:{displayName:"File Created By",description:"File Created By",type:"string"},fileCreatedByEmail:{displayName:"File Created By Email",description:"File Created By Email",type:"string"},fileMimeType:{displayName:"File Mime Type",description:"File Mime Type",type:"string"},filePath:{displayName:"File Path",description:"File Path",type:"string"},folderName:{displayName:"Folder Name",description:"Folder Name",type:"string"},folderPath:{displayName:"Folder Path",description:"Folder Path",type:"string"}},methods:{searchFile:{displayName:"Search for a file in my OneDrive",type:"read",inputs:["fileName","filePath"],requiredInputs:["fileName"],outputs:["fileId","fileWebUrl","fileSize","fileName","fileCreatedDate","fileCreatedBy","fileCreatedByEmail","fileMimeType"]},createFolder:{displayName:"Create Folder",type:"execute",inputs:["folderName","folderPath"],requiredInputs:["folderName"],outputs:[]}}}}})},onexecute=function({objectName:e,methodName:i,parameters:t,properties:l}){switch(e){case"drive":!function(e,i,t){switch(e){case"searchFile":!function(e,i){!function(e,i,t){let l=i.fileName,s=i.filePath;if("string"!=typeof l)throw new Error("properties[FileName] is not of type string");var r;r="string"==typeof s&&""!=s?`https://graph.microsoft.com/v1.0/me/drive/root:/${s}:/search(q='${l}')`:`https://graph.microsoft.com/v1.0/me/drive/root/search(q='${l}')`;!function(e,i,t,l){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(console.log("ExecuteRequest XHR status: "+s.status+","+s.responseText),4===s.readyState)if(201==s.status){var e=JSON.parse(s.responseText);"function"==typeof l&&l(e)}else if(204==s.status)"function"==typeof l&&l(s.responseText);else if(200==s.status){e=JSON.parse(s.responseText);"function"==typeof l&&l(e)}else if(202==s.status)"function"==typeof l&&l(null);else{if(400==s.status){e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if(404!=s.status){postResult({});e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if("No Team found with Group id"!=(e=JSON.parse(s.responseText)).error.message.startswith)throw new Error(e.error.code+": "+e.error.message)}},console.log("MSTeamsConnector ExecuteRequest: "+e),s.open(t.toUpperCase(),e),s.withCredentials=!0,s.setRequestHeader("Accept","application/json"),("PUT"==t.toUpperCase()||"POST"==t.toUpperCase()||"PATCH"==t.toUpperCase())&&s.setRequestHeader("Content-Type","application/json");s.send(i)}(r,null,"GET",(function(e){"function"==typeof t&&t(e)}))}(0,i,(function(e){var i={fileId:"",fileWebUrl:"",fileSize:0,fileName:"",fileCreatedDate:null,fileCreatedBy:"",fileCreatedByEmail:"",fileMimeType:""};e.value.length>0&&(i.fileId=e.value[0].id,i.fileWebUrl=e.value[0].webUrl,i.fileSize=e.value[0].size,i.fileName=e.value[0].name,i.fileCreatedDate=Date.parse(e.value[0].createdDateTime),i.fileCreatedBy=e.value[0].createdBy.user.displayName,i.fileCreatedByEmail=e.value[0].createdBy.user.email,i.fileMimeType=e.value[0].file.mimeType),postResult(i)}))}(0,t);break;case"createFolder":postResult({});break;default:throw new Error("The method "+e+" is not supported..")}}(i,0,l);break;default:throw new Error("The object "+e+" is not supported.")}};let i=null;e("postSchema",(function(e){i=e,console.log("postSchema:"),console.log(i)})),e("postResult",(function(e){}));e("XMLHttpRequest",class{constructor(){this.recorder={},this.recorder.headers={}}open(e,i){this.recorder.opened={method:e,url:i}}setRequestHeader(e,i){this.recorder.headers[e]=i}send(e){const i=require("request");this.withCredentials&&this.setRequestHeader("Authorization","Bearer eyJ0eXAiOiJKV1QiLCJub25jZSI6InNsTkNXR0pMR0pMRW5yLTRnYTdXT2tJd0NfWWo0UU5CQkotTzFJM1lQZm8iLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mMGNkM2U0ZC00NDAyLTQ5NDAtODQyYi03ZjRjZGU2YjRjM2YvIiwiaWF0IjoxNjIwOTA5NzI2LCJuYmYiOjE2MjA5MDk3MjYsImV4cCI6MTYyMDk5NjQyNSwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiRTJaZ1lOZ1I5ZjVZZVJybko2M2dxdXh2LzIyVEJGMUZORmhNL05tV1ZUVkpMallQV1FBQSIsImFtciI6WyJwd2QiXSwiYXBwX2Rpc3BsYXluYW1lIjoiR3JhcGggZXhwbG9yZXIgKG9mZmljaWFsIHNpdGUpIiwiYXBwaWQiOiJkZThiYzhiNS1kOWY5LTQ4YjEtYThhZC1iNzQ4ZGE3MjUwNjQiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IkhheXRlciIsImdpdmVuX25hbWUiOiJFcm5pZSIsImlkdHlwIjoidXNlciIsImlwYWRkciI6IjgyLjEyLjE1Ni4xODQiLCJuYW1lIjoiRXJuaWUgSGF5dGVyIiwib2lkIjoiOWQzODI0YjUtOGQ0Mi00NThhLTgyNzUtN2E2MDAzN2FkOTI1IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAwQTIyNjQ0NEQiLCJyaCI6IjAuQVJBQVRUN044QUpFUUVtRUszOU0zbXRNUDdYSWk5NzUyYkZJcUsyM1NOcHlVR1FRQUpJLiIsInNjcCI6IkNhbGVuZGFycy5SZWFkV3JpdGUgQ2hhbm5lbE1lbWJlci5SZWFkLkFsbCBDaGFubmVsTWVtYmVyLlJlYWRXcml0ZS5BbGwgQ2hhbm5lbE1lc3NhZ2UuUmVhZC5BbGwgQ2hhbm5lbE1lc3NhZ2UuU2VuZCBDb250YWN0cy5SZWFkV3JpdGUgRGV2aWNlTWFuYWdlbWVudEFwcHMuUmVhZFdyaXRlLkFsbCBEZXZpY2VNYW5hZ2VtZW50Q29uZmlndXJhdGlvbi5SZWFkLkFsbCBEZXZpY2VNYW5hZ2VtZW50Q29uZmlndXJhdGlvbi5SZWFkV3JpdGUuQWxsIERldmljZU1hbmFnZW1lbnRNYW5hZ2VkRGV2aWNlcy5Qcml2aWxlZ2VkT3BlcmF0aW9ucy5BbGwgRGV2aWNlTWFuYWdlbWVudE1hbmFnZWREZXZpY2VzLlJlYWQuQWxsIERldmljZU1hbmFnZW1lbnRNYW5hZ2VkRGV2aWNlcy5SZWFkV3JpdGUuQWxsIERldmljZU1hbmFnZW1lbnRSQkFDLlJlYWQuQWxsIERldmljZU1hbmFnZW1lbnRSQkFDLlJlYWRXcml0ZS5BbGwgRGV2aWNlTWFuYWdlbWVudFNlcnZpY2VDb25maWcuUmVhZC5BbGwgRGV2aWNlTWFuYWdlbWVudFNlcnZpY2VDb25maWcuUmVhZFdyaXRlLkFsbCBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCBGaWxlcy5SZWFkV3JpdGUuQWxsIEdyb3VwLlJlYWQuQWxsIEdyb3VwLlJlYWRXcml0ZS5BbGwgSWRlbnRpdHlSaXNrRXZlbnQuUmVhZC5BbGwgTWFpbC5SZWFkV3JpdGUgTWFpbGJveFNldHRpbmdzLlJlYWRXcml0ZSBOb3Rlcy5SZWFkV3JpdGUuQWxsIG9wZW5pZCBQZW9wbGUuUmVhZCBQb2xpY3kuUmVhZFdyaXRlLkFwcGxpY2F0aW9uQ29uZmlndXJhdGlvbiBwcm9maWxlIFJlcG9ydHMuUmVhZC5BbGwgU2l0ZXMuUmVhZC5BbGwgU2l0ZXMuUmVhZFdyaXRlLkFsbCBUYXNrcy5SZWFkV3JpdGUgVGVhbXNUYWIuUmVhZFdyaXRlLkFsbCBUZWFtc1RhYi5SZWFkV3JpdGVGb3JUZWFtIFVzZXIuUmVhZCBVc2VyLlJlYWRCYXNpYy5BbGwgVXNlci5SZWFkV3JpdGUgVXNlci5SZWFkV3JpdGUuQWxsIGVtYWlsIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoieFl2NTdPVG5pN2xFazR6WlJacWUzTWt1bEl3S1AtVG4tcml6VVJOcEtVdyIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6ImYwY2QzZTRkLTQ0MDItNDk0MC04NDJiLTdmNGNkZTZiNGMzZiIsInVuaXF1ZV9uYW1lIjoiZXJuaWVAZGVuYWxsaXh0ZWNoZXUub25taWNyb3NvZnQuY29tIiwidXBuIjoiZXJuaWVAZGVuYWxsaXh0ZWNoZXUub25taWNyb3NvZnQuY29tIiwidXRpIjoiQTdyTzliWVBPa0sycU9INjhBVklBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiNjJlOTAzOTQtNjlmNS00MjM3LTkxOTAtMDEyMTc3MTQ1ZTEwIiwiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19zdCI6eyJzdWIiOiI5MGE4Tl9RNURBSE5OZW9yS3hYRzFmcFJDZW9ZbGwxVHdzSjVRU09ndkZBIn0sInhtc190Y2R0IjoxNDMxNjMwMzAxfQ.ln3gHGpgO0T1KqGXeSp9WokS-Ai4J1iL4iiG5t9nh9bIGIM7-dUnYAcah26CJGOEqjryuC_TGE6BI4VtFMf4l8CeAEweSmIeLnjiBZO8dTnQDUjRs7r4g_8iI9qo4vIcIYH-1TiJ-0HCE2CRHkcehaVwy4mZYHcBfJ1lQcUapsWl4-y7y-guMa2fLkAMOFVmEjNNxw7qxkyIT0iilZuypVcABBvpg2ATly5inNXDVMg-AloYN3aqpLTMmmaJwJcodmxZlGmn9OS76qCMhD6UvsH04sQjzP0BpHb-NIS6tOng85pQqs6To0uaqmHhwFg7o5IyWAVpRqgmcYI17EDcLg");const t={method:this.recorder.opened.method,url:this.recorder.opened.url,headers:this.recorder.headers,body:e,strictSSL:!1};new Promise((e,l)=>{try{i(t,(i,t,l)=>{i?console.error("error inside request:"+i):(this.responseText=l,this.readyState=4,this.status=t.statusCode,this.onreadystatechange(),e(l),delete this.responseText)})}catch(e){console.log("error ouside request "+e),l()}}).catch(e=>{console.log("Promise error:"+e)})}}),onexecute({objectName:"drive",methodName:"createFolder",properties:{folderName:"Ernie Test"},parameters:{},configuration:{},schema:{}})}();
//# sourceMappingURL=run.js.map
