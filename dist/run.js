!function(){metadata={systemName:"MSExcelTodoJSSP",displayName:"Microsoft Excel and To Do",description:"A connector for Microsoft Excel and To Do"};function e(e,t){global[e]=t}ondescribe=function(){postSchema({objects:{drive:{displayName:"Drive",description:"Drive",properties:{fileId:{displayName:"File ID",description:"File ID",type:"string"},fileWebUrl:{displayName:"File Web URL",description:"File Web URL",type:"string"},fileSize:{displayName:"File Size",description:"File Size",type:"number"},fileName:{displayName:"File Name",description:"File Name",type:"string"},fileCreatedDate:{displayName:"File Created Date",description:"File Created Date",type:"dateTime"},fileCreatedBy:{displayName:"File Created By",description:"File Created By",type:"string"},fileCreatedByEmail:{displayName:"File Created By Email",description:"File Created By Email",type:"string"},fileMimeType:{displayName:"File Mime Type",description:"File Mime Type",type:"string"},filePath:{displayName:"File Path",description:"File Path",type:"string"}},methods:{searchFile:{displayName:"Search for a file in my OneDrive",type:"read",inputs:["fileName","filePath"],requiredInputs:["fileName"],outputs:["fileId","fileWebUrl","fileSize","fileName","fileCreatedDate","fileCreatedBy","fileCreatedByEmail","fileMimeType"]}}}}})},onexecute=function({objectName:e,methodName:t,parameters:r,properties:i}){switch(e){case"drive":!function(e,t,r){switch(e){case"searchFile":!function(e,t){!function(e,t,r){let i=t.fileName,s=t.filePath;if("string"!=typeof i)throw new Error("properties[FileName] is not of type string");var a;a="string"==typeof s&&""!=s?`https://graph.microsoft.com/v1.0/me/drive/root:/${s}:/search(q='${i}')`:`https://graph.microsoft.com/v1.0/me/drive/root/search(q='${i}')`;!function(e,t,r,i){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(console.log("ExecuteRequest XHR status: "+s.status+","+s.responseText),4===s.readyState)if(201==s.status){var e=JSON.parse(s.responseText);"function"==typeof i&&i(e)}else if(204==s.status)"function"==typeof i&&i(s.responseText);else if(200==s.status){e=JSON.parse(s.responseText);"function"==typeof i&&i(e)}else if(202==s.status)"function"==typeof i&&i(null);else{if(400==s.status){e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if(404!=s.status){postResult({});e=JSON.parse(s.responseText);throw new Error(e.error.code+": "+e.error.message)}if("No Team found with Group id"!=(e=JSON.parse(s.responseText)).error.message.startswith)throw new Error(e.error.code+": "+e.error.message)}},console.log("MSTeamsConnector ExecuteRequest: "+e),s.open(r.toUpperCase(),e),s.withCredentials=!0,s.setRequestHeader("Accept","application/json"),("PUT"==r.toUpperCase()||"POST"==r.toUpperCase()||"PATCH"==r.toUpperCase())&&s.setRequestHeader("Content-Type","application/json");s.send(t)}(a,null,"GET",(function(e){"function"==typeof r&&r(e)}))}(0,t,(function(e){var t={fileId:"",fileWebUrl:"",fileSize:0,fileName:"",fileCreatedDate:null,fileCreatedBy:"",fileCreatedByEmail:"",fileMimeType:""};e.value.length>0&&(t.fileId=e.value[0].id,t.fileWebUrl=e.value[0].webUrl,t.fileSize=e.value[0].size,t.fileName=e.value[0].name,t.fileCreatedDate=e.value[0].createdDateTime,t.fileCreatedBy=e.value[0].createdBy.displayName,t.fileCreatedByEmail=e.value[0].createdBy.email,t.fileMimeType=e.value[0].file.mimeType),postResult(t)}))}(0,r);break;default:throw new Error("The method "+e+" is not supported..")}}(t,0,i);break;default:throw new Error("The object "+e+" is not supported.")}};let t=null;e("postSchema",(function(e){t=e,console.log("postSchema:"),console.log(t)})),e("postResult",(function(e){}));e("XMLHttpRequest",class{constructor(){this.recorder={},this.recorder.headers={}}open(e,t){this.recorder.opened={method:e,url:t}}setRequestHeader(e,t){this.recorder.headers[e]=t}send(e){const t=require("request");this.withCredentials&&this.setRequestHeader("Authorization","Bearer ");const r={method:this.recorder.opened.method,url:this.recorder.opened.url,headers:this.recorder.headers,body:e,strictSSL:!1};new Promise((e,i)=>{try{t(r,(t,r,i)=>{t?console.error("error inside request:"+t):(this.responseText=i,this.readyState=4,this.status=r.statusCode,this.onreadystatechange(),e(i),delete this.responseText)})}catch(e){console.log("error ouside request "+e),i()}}).catch(e=>{console.log("Promise error:"+e)})}}),onexecute({objectName:"channel",methodName:"getMessages",properties:{teamId:"26be3fc7-57f3-4978-aab4-9ed41c84e271",id:"19:ee6a2aa128574128896abdb0c152b24f@thread.tacv2"},parameters:{},configuration:{},schema:{}})}();
//# sourceMappingURL=run.js.map
