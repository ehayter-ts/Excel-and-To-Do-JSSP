{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import '@k2oss/k2-broker-core';\r\n\r\nmetadata = {\r\n    systemName: \"MSExcelPlannerJSSP\",\r\n    displayName: \"Microsoft Excel and Planner\",\r\n    description: \"A connector for Microsoft Excel and Planner\"\r\n};\r\n\r\n// Constants\r\nconst baseUriEndpoint = \"https://graph.microsoft.com/v1.0\";\r\n\r\n//\r\n// Objects\r\nconst Drive = \"drive\";\r\nconst Excel = \"excel\";\r\nconst Group = \"group\";\r\nconst Planner = \"planner\";\r\nconst User = \"user\";\r\n\r\n//\r\n//Drive\r\nconst FileId = \"fileId\";\r\nconst FileWebUrl = \"fileWebUrl\";\r\nconst FileSize = \"fileSize\";\r\nconst FileName = \"fileName\";\r\nconst FileCreated = \"fileCreatedDate\";\r\nconst FileCreatedBy = \"fileCreatedBy\";\r\nconst FileCreatedByEmail = \"fileCreatedByEmail\";\r\nconst FileMimeType = \"fileMimeType\";\r\nconst FilePath = \"filePath\";\r\nconst FolderName = \"folderName\";\r\nconst FolderPath = \"folderPath\";\r\nconst File = \"file\";\r\n\r\nconst FileSearch = \"searchFile\";\r\nconst CreateFolder = \"createFolder\";\r\n\r\n//\r\n//Excel\r\nconst ExcelSheetName = \"sheetName\";\r\nconst Column1 = \"column1\";\r\nconst Column2 = \"column2\";\r\nconst Column3 = \"column3\";\r\nconst Column4 = \"column4\";\r\nconst Column5 = \"column5\";\r\nconst Column6 = \"column6\";\r\nconst Column7 = \"column7\";\r\nconst Column8 = \"column8\";\r\nconst Column9 = \"column9\";\r\nconst Column10 = \"column10\";\r\nconst Column11 = \"column11\";\r\nconst Column12 = \"column12\";\r\nconst Column13 = \"column13\";\r\nconst Column14 = \"column14\";\r\nconst Column15 = \"column15\";\r\nconst Column16 = \"column16\";\r\nconst Column17 = \"column17\";\r\nconst Column18 = \"column18\";\r\nconst Column19 = \"column19\";\r\nconst Column20 = \"column20\";\r\nconst ColumnName = \"columnName\";\r\nconst WorksheetName = \"worksheetName\";\r\nconst WorksheetId = \"worksheetId\";\r\nconst WorksheetPosition = \"worksheetPosition\";\r\nconst WorksheetVisibility = \"worksheetVisibility\";\r\nconst WorksheetRange = \"worksheetRange\";\r\nconst RowCount = \"rowCount\";\r\nconst ColumnCount = \"columnCount\";\r\nconst CellValue = \"cellValue\";\r\n\r\nconst UsedRangeItems = \"getUsedRangeItems\";\r\nconst GetUsedRangeColumnNames = \"getUsedRangeColumnNames\";\r\nconst GetRangeColumnNames = \"getRangeColumnNames\";\r\nconst GetWorkbookWorksheets = \"getWorkbookWorksheets\";\r\nconst GetRangeItems = \"getRangeItems\";\r\nconst UsedRange = \"getUsedRange\";\r\nconst GetCell = \"getCell\";\r\nconst GetRow = \"getRow\";\r\nconst GetRangeRow = \"getRangeRow\";\r\n\r\n//\r\n//Group\r\nconst GroupId = \"groupId\";\r\nconst GroupName = \"groupName\";\r\nconst GroupDescription = \"groupDescription\";\r\nconst GroupMail = \"groupMail\";\r\nconst GroupVisibility = \"groupVisibility\";\r\nconst GroupMailNickname = \"groupMailNickname\";\r\nconst GroupMailEnabled = \"groupMailEnabled\";\r\nconst GroupSecurityEnabled = \"groupSecurityEnabled\";\r\nconst GroupOwnerId = \"groupOwnerId\";\r\n\r\nconst GetGroups = \"getGroups\";\r\nconst CreateGroup = \"createGroup\";\r\nconst AddMemberToGroup = \"addMemberToGroup\";\r\n\r\n//\r\n//Planner\r\nconst PlanTitle = \"planTitle\";\r\nconst PlanOwnerGroup = \"ownerGroup\";\r\nconst PlanId = \"planId\";\r\nconst BucketName = \"bucketName\";\r\nconst BucketId = \"bucketId\";\r\nconst TaskId = \"taskId\";\r\nconst TaskTitle = \"taskTitle\";\r\nconst TaskUserId = \"taskUserId\";\r\nconst TaskDueDate = \"taskDueDate\";\r\n\r\nconst CreatePlan = \"createPlan\";\r\nconst CreateBucket = \"createBucket\";\r\nconst GetGroupPlans = \"getGroupPlans\";\r\nconst GetPlanBuckets = \"getPlanBuckets\";\r\nconst CreateTask = \"createTask\";\r\n\r\n//\r\n//User\r\nconst UserEmail = \"userEmail\";\r\nconst UserId = \"userId\";\r\nconst UserDisplayName = \"userDisplayName\";\r\nconst UserGivenName = \"userGivenName\";\r\nconst UserLastName = \"userLastName\";\r\nconst UserJobTitle = \"userJobTitle\";\r\n\r\nconst GetUserByEmail = \"getUserByEmail\";\r\n\r\n//OnDescribe\r\nondescribe = function () {\r\n    postSchema({\r\n\r\n        objects: {\r\n            [Drive]: {\r\n                displayName: \"Drive\",\r\n                description: \"Drive\",\r\n                properties: {\r\n                    [FileId]: {\r\n                        displayName: \"File ID\",\r\n                        description: \"File ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FileWebUrl]: {\r\n                        displayName: \"File Web URL\",\r\n                        description: \"File Web URL\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FileSize]: {\r\n                        displayName: \"File Size\",\r\n                        description: \"File Size\",\r\n                        type: \"number\"\r\n                    },\r\n                    [FileName]: {\r\n                        displayName: \"File Name\",\r\n                        description: \"File Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FileCreated]: {\r\n                        displayName: \"File Created Date\",\r\n                        description: \"File Created Date\",\r\n                        type: \"dateTime\"\r\n                    },\r\n                    [FileCreatedBy]: {\r\n                        displayName: \"File Created By\",\r\n                        description: \"File Created By\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FileCreatedByEmail]: {\r\n                        displayName: \"File Created By Email\",\r\n                        description: \"File Created By Email\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FileMimeType]: {\r\n                        displayName: \"File Mime Type\",\r\n                        description: \"File Mime Type\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FilePath]: {\r\n                        displayName: \"File Path\",\r\n                        description: \"File Path\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FolderName]: {\r\n                        displayName: \"Folder Name\",\r\n                        description: \"Folder Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [FolderPath]: {\r\n                        displayName: \"Folder Path\",\r\n                        description: \"Folder Path\",\r\n                        type: \"string\"\r\n                    },\r\n                    [File]: {\r\n                        displayName: \"File\",\r\n                        description: \"File\",\r\n                        type: \"attachment\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [FileSearch]: {\r\n                        displayName: \"Search for a file in my OneDrive\",\r\n                        type: \"list\",\r\n                        inputs: [FileName, FilePath],\r\n                        requiredInputs: [FileName],\r\n                        outputs: [FileId, FileWebUrl, FileSize, FileName, FileCreated, FileCreatedBy, FileCreatedByEmail, FileMimeType]\r\n                    },\r\n                    [CreateFolder]: {\r\n                        displayName: \"Create Folder\",\r\n                        type: \"execute\",\r\n                        inputs: [FolderName, FolderPath],\r\n                        requiredInputs: [FolderName],\r\n                        outputs: []\r\n                    }\r\n                }\r\n            },\r\n            [Excel]: {\r\n                displayName: \"Excel\",\r\n                description: \"Excel\",\r\n                properties: {\r\n                    [FileId]: {\r\n                        displayName: \"File ID\",\r\n                        description: \"File ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ExcelSheetName]: {\r\n                        displayName: \"Sheet Name\",\r\n                        description: \"Sheet Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column1]: {\r\n                        displayName: \"Column 1\",\r\n                        description: \"Column 1\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column2]: {\r\n                        displayName: \"Column 2\",\r\n                        description: \"Column 2\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column3]: {\r\n                        displayName: \"Column 3\",\r\n                        description: \"Column 3\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column4]: {\r\n                        displayName: \"Column 4\",\r\n                        description: \"Column 4\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column5]: {\r\n                        displayName: \"Column 5\",\r\n                        description: \"Column 5\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column6]: {\r\n                        displayName: \"Column 6\",\r\n                        description: \"Column 6\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column7]: {\r\n                        displayName: \"Column 7\",\r\n                        description: \"Column 7\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column8]: {\r\n                        displayName: \"Column 8\",\r\n                        description: \"Column 8\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column9]: {\r\n                        displayName: \"Column 9\",\r\n                        description: \"Column 9\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column10]: {\r\n                        displayName: \"Column 10\",\r\n                        description: \"Column 10\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column11]: {\r\n                        displayName: \"Column 11\",\r\n                        description: \"Column 11\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column12]: {\r\n                        displayName: \"Column 12\",\r\n                        description: \"Column 12\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column13]: {\r\n                        displayName: \"Column 13\",\r\n                        description: \"Column 13\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column14]: {\r\n                        displayName: \"Column 14\",\r\n                        description: \"Column 14\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column15]: {\r\n                        displayName: \"Column 15\",\r\n                        description: \"Column 15\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column16]: {\r\n                        displayName: \"Column 16\",\r\n                        description: \"Column 16\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column17]: {\r\n                        displayName: \"Column 17\",\r\n                        description: \"Column 17\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column18]: {\r\n                        displayName: \"Column 18\",\r\n                        description: \"Column 18\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column19]: {\r\n                        displayName: \"Column 19\",\r\n                        description: \"Column 19\",\r\n                        type: \"string\"\r\n                    },\r\n                    [Column20]: {\r\n                        displayName: \"Column 20\",\r\n                        description: \"Column 20\",\r\n                        type: \"string\"\r\n                    },\r\n                    [ColumnName]: {\r\n                        displayName: \"Column Index\",\r\n                        description: \"Column Index\",\r\n                        type: \"string\"\r\n                    },\r\n                    [WorksheetId]: {\r\n                        displayName: \"Worksheet ID\",\r\n                        description: \"Worksheet ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [WorksheetName]: {\r\n                        displayName: \"Worksheet Name\",\r\n                        description: \"Worksheet Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [WorksheetPosition]: {\r\n                        displayName: \"Worksheet Position\",\r\n                        description: \"Worksheet Position\",\r\n                        type: \"string\"\r\n                    },\r\n                    [WorksheetVisibility]: {\r\n                        displayName: \"Worksheet Visibility\",\r\n                        description: \"Worksheet Visibility\",\r\n                        type: \"string\"\r\n                    },\r\n                    [WorksheetRange]: {\r\n                        displayName: \"Worksheet Range\",\r\n                        description: \"Worksheet Range\",\r\n                        type: \"string\"\r\n                    },\r\n                    [RowCount]: {\r\n                        displayName: \"Row Count\",\r\n                        description: \"Row Count\",\r\n                        type: \"number\"\r\n                    },\r\n                    [ColumnCount]: {\r\n                        displayName: \"Column Count\",\r\n                        description: \"Column Count\",\r\n                        type: \"number\"\r\n                    },\r\n                    [CellValue]: {\r\n                        displayName: \"Cell Value\",\r\n                        description: \"Cell Value\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [UsedRange]: {\r\n                        displayName: \"Get Used Range\",\r\n                        type: \"read\",\r\n                        inputs: [FileId, ExcelSheetName],\r\n                        requiredInputs: [FileId, ExcelSheetName],\r\n                        outputs: [WorksheetRange]\r\n                    },\r\n                    [UsedRangeItems]: {\r\n                        displayName: \"Get Worksheet Rows in Used Range\",\r\n                        type: \"list\",\r\n                        inputs: [FileId, ExcelSheetName],\r\n                        requiredInputs: [FileId, ExcelSheetName],\r\n                        outputs: [Column1, Column2, Column3, Column4, Column5, Column6, Column7, Column8, Column9, Column10, Column11, Column12, Column13, Column14, Column15, Column16, Column17, Column18, Column19, Column20]\r\n                    },\r\n                    [GetUsedRangeColumnNames]: {\r\n                        displayName: \"Get Used Range Column Counts\",\r\n                        type: \"list\",\r\n                        inputs: [FileId, ExcelSheetName],\r\n                        requiredInputs: [FileId, ExcelSheetName],\r\n                        outputs: [ColumnName]\r\n                    },\r\n                    [GetRangeColumnNames]: {\r\n                        displayName: \"Get Range Column Counts\",\r\n                        type: \"list\",\r\n                        inputs: [FileId, ExcelSheetName, WorksheetRange],\r\n                        requiredInputs: [FileId, ExcelSheetName, WorksheetRange],\r\n                        outputs: [ColumnName]\r\n                    },\r\n                    [GetWorkbookWorksheets]: {\r\n                        displayName: \"Get Worksheets\",\r\n                        type: \"list\",\r\n                        inputs: [FileId],\r\n                        requiredInputs: [FileId],\r\n                        outputs: [WorksheetId, WorksheetName, WorksheetPosition, WorksheetVisibility]\r\n                    },\r\n                    [GetRangeItems]: {\r\n                        displayName: \"Get Worksheet Rows in a Specified Range\",\r\n                        type: \"list\",\r\n                        inputs: [FileId, ExcelSheetName, WorksheetRange],\r\n                        requiredInputs: [FileId, ExcelSheetName, WorksheetRange],\r\n                        outputs: [Column1, Column2, Column3, Column4, Column5, Column6, Column7, Column8, Column9, Column10, Column11, Column12, Column13, Column14, Column15, Column16, Column17, Column18, Column19, Column20]\r\n                    },\r\n                    [GetCell]: {\r\n                        displayName: \"Get a Cell Value\",\r\n                        type: \"read\",\r\n                        inputs: [FileId, ExcelSheetName, WorksheetRange, RowCount, ColumnCount],\r\n                        requiredInputs: [FileId, ExcelSheetName, WorksheetRange, RowCount, ColumnCount],\r\n                        outputs: [CellValue]\r\n                    },\r\n                    [GetRow]: {\r\n                        displayName: \"Get a Worksheet Row in Used Range\",\r\n                        type: \"read\",\r\n                        inputs: [FileId, ExcelSheetName, RowCount],\r\n                        requiredInputs: [FileId, ExcelSheetName, RowCount],\r\n                        outputs: [Column1, Column2, Column3, Column4, Column5, Column6, Column7, Column8, Column9, Column10, Column11, Column12, Column13, Column14, Column15, Column16, Column17, Column18, Column19, Column20]\r\n                    },\r\n                    [GetRangeRow]: {\r\n                        displayName: \"Get a Worksheet Row in Range\",\r\n                        type: \"read\",\r\n                        inputs: [FileId, ExcelSheetName, WorksheetRange, RowCount],\r\n                        requiredInputs: [FileId, ExcelSheetName, WorksheetRange, RowCount],\r\n                        outputs: [Column1, Column2, Column3, Column4, Column5, Column6, Column7, Column8, Column9, Column10, Column11, Column12, Column13, Column14, Column15, Column16, Column17, Column18, Column19, Column20]\r\n                    }\r\n                }\r\n            },\r\n            [Group]: {\r\n                displayName: \"Group\",\r\n                description: \"Group\",\r\n                properties: {\r\n                    [GroupId]: {\r\n                        displayName: \"Group ID\",\r\n                        description: \"Group ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupName]: {\r\n                        displayName: \"Group Name\",\r\n                        description: \"Group Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupDescription]: {\r\n                        displayName: \"Group Description\",\r\n                        description: \"Group Description\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupMail]: {\r\n                        displayName: \"Group Mail\",\r\n                        description: \"Group Mail\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupVisibility]: {\r\n                        displayName: \"Group Visibility\",\r\n                        description: \"Group Visibility\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupMailEnabled]: {\r\n                        displayName: \"Mail Enabled\",\r\n                        description: \"Mail Enabled\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [GroupMailNickname]: {\r\n                        displayName: \"Mail Nickname\",\r\n                        description: \"Mail Nickname\",\r\n                        type: \"string\"\r\n                    },\r\n                    [GroupSecurityEnabled]: {\r\n                        displayName: \"Security Enabled\",\r\n                        description: \"Security Enabled\",\r\n                        type: \"boolean\"\r\n                    },\r\n                    [GroupOwnerId]: {\r\n                        displayName: \"Group Owner ID\",\r\n                        description: \"Group Owner ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserId]: {\r\n                        displayName: \"User ID\",\r\n                        description: \"User ID\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [GetGroups]: {\r\n                        displayName: \"Get all Groups in Organisation\",\r\n                        type: \"list\",\r\n                        inputs: [],\r\n                        requiredInputs: [],\r\n                        outputs: [GroupId, GroupName, GroupDescription, GroupMail, GroupVisibility]\r\n                    },\r\n                    [CreateGroup]: {\r\n                        displayName: \"Create Group\",\r\n                        type: \"execute\",\r\n                        inputs: [GroupName, GroupDescription, GroupVisibility, GroupMailEnabled, GroupMailNickname, GroupSecurityEnabled, GroupOwnerId],\r\n                        requiredInputs: [GroupName, GroupMailEnabled, GroupMailNickname, GroupSecurityEnabled, GroupOwnerId],\r\n                        outputs: [GroupId, GroupName, GroupDescription, GroupMail, GroupVisibility]\r\n                    },\r\n                    [AddMemberToGroup]: {\r\n                        displayName: \"Add Member to Group\",\r\n                        type: \"execute\",\r\n                        inputs: [GroupId, UserId],\r\n                        requiredInputs: [GroupId, UserId],\r\n                        outputs: []\r\n                    }\r\n                }\r\n            },\r\n            [Planner]: {\r\n                displayName: \"Planner\",\r\n                description: \"Planner\",\r\n                properties: {\r\n                    [PlanTitle]: {\r\n                        displayName: \"Planner Title\",\r\n                        description: \"Planner Title\",\r\n                        type: \"string\"\r\n                    },\r\n                    [PlanOwnerGroup]: {\r\n                        displayName: \"Owner Group ID\",\r\n                        description: \"Owner Group ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [PlanId]: {\r\n                        displayName: \"Plan ID\",\r\n                        description: \"Plan ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [BucketName]: {\r\n                        displayName: \"Bucket Name\",\r\n                        description: \"Bucket Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [BucketId]: {\r\n                        displayName: \"Bucket ID\",\r\n                        description: \"Bucket ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TaskTitle]: {\r\n                        displayName: \"Task Title\",\r\n                        description: \"Task Title\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TaskUserId]: {\r\n                        displayName: \"Task Assigned To User ID\",\r\n                        description: \"Task Assigned To User ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [TaskDueDate]: {\r\n                        displayName: \"Task Due Date\",\r\n                        description: \"Task Due Date\",\r\n                        type: \"dateTime\"\r\n                    },\r\n                    [TaskId]: {\r\n                        displayName: \"Task ID\",\r\n                        description: \"Task ID\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [CreatePlan]: {\r\n                        displayName: \"Create Plan\",\r\n                        type: \"execute\",\r\n                        inputs: [PlanTitle, PlanOwnerGroup],\r\n                        requiredInputs: [PlanTitle, PlanOwnerGroup],\r\n                        outputs: [PlanId]\r\n                    },\r\n                    [CreateBucket]: {\r\n                        displayName: \"Create Bucket\",\r\n                        type: \"execute\",\r\n                        inputs: [BucketName, PlanId],\r\n                        requiredInputs: [BucketName, PlanId],\r\n                        outputs: [BucketId]\r\n                    },\r\n                    [GetGroupPlans]: {\r\n                        displayName: \"Get Group Plans\",\r\n                        type: \"list\",\r\n                        inputs: [PlanOwnerGroup],\r\n                        requiredInputs: [PlanOwnerGroup],\r\n                        outputs: [PlanId, PlanTitle]\r\n                    },\r\n                    [GetPlanBuckets]: {\r\n                        displayName: \"Get Plan Buckets\",\r\n                        type: \"list\",\r\n                        inputs: [PlanId],\r\n                        requiredInputs: [PlanId],\r\n                        outputs: [BucketId, BucketName]\r\n                    },\r\n                    [CreateTask]: {\r\n                        displayName: \"Create Task\",\r\n                        type: \"execute\",\r\n                        inputs: [PlanId, TaskTitle, TaskUserId, BucketId, TaskDueDate],\r\n                        requiredInputs: [PlanId, TaskTitle, TaskUserId],\r\n                        outputs: [TaskId]\r\n                    }\r\n                }\r\n            },\r\n            [User]: {\r\n                displayName: \"User\",\r\n                description: \"User\",\r\n                properties: {\r\n                    [UserEmail]: {\r\n                        displayName: \"User Email\",\r\n                        description: \"User Email\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserId]: {\r\n                        displayName: \"User ID\",\r\n                        description: \"User ID\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserDisplayName]: {\r\n                        displayName: \"User Display Name\",\r\n                        description: \"User Display Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserGivenName]: {\r\n                        displayName: \"User Given Name\",\r\n                        description: \"User Given Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserLastName]: {\r\n                        displayName: \"User Last Name\",\r\n                        description: \"User Last Name\",\r\n                        type: \"string\"\r\n                    },\r\n                    [UserJobTitle]: {\r\n                        displayName: \"User Job Title\",\r\n                        description: \"User Job Title\",\r\n                        type: \"string\"\r\n                    }\r\n                },\r\n                methods: {\r\n                    [GetUserByEmail]: {\r\n                        displayName: \"Get User by Email\",\r\n                        type: \"read\",\r\n                        inputs: [UserEmail],\r\n                        requiredInputs: [UserEmail],\r\n                        outputs: [UserId, UserDisplayName, UserEmail, UserGivenName, UserLastName, UserJobTitle]\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    });\r\n}\r\n\r\n// OnExecute\r\nonexecute = function ({ objectName, methodName, parameters, properties }) {\r\n    switch (objectName) {\r\n        case Drive:\r\n            onexecuteDrive(methodName, parameters, properties);\r\n            break;\r\n        case Excel:\r\n            onexecuteExcel(methodName, parameters, properties);\r\n            break;\r\n        case Group:\r\n            onexecuteGroup(methodName, parameters, properties);\r\n            break;\r\n        case Planner:\r\n            onexecutePlanner(methodName, parameters, properties);\r\n            break;\r\n        case User:\r\n            onexecuteUser(methodName, parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The object \" + objectName + \" is not supported.\");\r\n    }\r\n}\r\n\r\nfunction onexecuteDrive(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case FileSearch:\r\n            onexecuteSearchFile(parameters, properties);\r\n            break;\r\n        case CreateFolder:\r\n            onexecuteCreateFolder(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteExcel(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case UsedRange:\r\n            onexecuteGetUsedRange(parameters, properties);\r\n            break;\r\n        case UsedRangeItems:\r\n            onexecuteUsedRange(parameters, properties);\r\n            break;\r\n        case GetUsedRangeColumnNames:\r\n            onexecuteGetUsedRangeColumnNames(parameters, properties);\r\n            break;\r\n        case GetRangeColumnNames:\r\n            onexecuteGetRangeColumnNames(parameters, properties);\r\n            break;\r\n        case GetWorkbookWorksheets:\r\n            onexecuteGetWorksheets(parameters, properties);\r\n            break;\r\n        case GetRangeItems:\r\n            onexecuteGetRangeItems(parameters, properties);\r\n            break;\r\n        case GetCell:\r\n            onexecuteGetCell(parameters, properties);\r\n            break;\r\n        case GetRow:\r\n            onexecuteGetUsedRangeRow(parameters, properties);\r\n            break;\r\n        case GetRangeRow:\r\n            onexecuteGetRangeRow(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteGroup(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case GetGroups:\r\n            onexecuteGetGroups(parameters, properties);\r\n            break;\r\n        case CreateGroup:\r\n            onexecuteCreateGroup(parameters, properties);\r\n            break;\r\n        case AddMemberToGroup:\r\n            onexecuteAddUserToGroup(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecutePlanner(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case CreatePlan:\r\n            onexecuteCreatePlan(parameters, properties);\r\n            break;\r\n        case CreateBucket:\r\n            onexecuteCreateBucket(parameters, properties);\r\n            break;\r\n        case GetGroupPlans:\r\n            onexecuteGetPlans(parameters, properties);\r\n            break;\r\n        case GetPlanBuckets:\r\n            onexecuteGetBuckets(parameters, properties);\r\n            break;\r\n        case CreateTask:\r\n            onexecuteCreateTask(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction onexecuteUser(methodName: string, parameters: SingleRecord, properties: SingleRecord) {\r\n    switch (methodName) {\r\n        case GetUserByEmail:\r\n            onexecuteGetUser(parameters, properties);\r\n            break;\r\n        default: throw new Error(\"The method \" + methodName + \" is not supported..\");\r\n    }\r\n}\r\n\r\nfunction ExecuteRequest(url: string, data: string, requestType: string, cb) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = function () {\r\n        console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n        if (xhr.readyState !== 4)\r\n            return;\r\n        if (xhr.status == 201) {\r\n            //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n            var obj;\r\n\r\n            try {\r\n                obj = JSON.parse(xhr.responseText);\r\n            }\r\n            catch (e) {\r\n                //do nothing\r\n            }\r\n\r\n            if (typeof cb === 'function')\r\n                cb(obj);\r\n        }\r\n        else if (xhr.status == 204) {\r\n            if (typeof cb === 'function')\r\n                cb(xhr.responseText);\r\n        }\r\n        else if (xhr.status == 200) {\r\n            var obj = JSON.parse(xhr.responseText);\r\n            //console.log(\"ExecuteRequest XHR status: \" + xhr.status + \",\" + xhr.responseText);\r\n            //console.log(\"ExecuteRequest cb type of: \" + (typeof cb).toString());\r\n            if (typeof cb === 'function')\r\n                cb(obj);\r\n        }\r\n        else if (xhr.status == 202) {\r\n            if (typeof cb === 'function')\r\n                cb(null);\r\n        }\r\n        else if (xhr.status == 400) {\r\n            // This is a bad request, return error to UI\r\n            var obj = JSON.parse(xhr.responseText);\r\n            throw new Error(obj.error.code + \": \" + obj.error.message);\r\n        }\r\n        else if (xhr.status == 404) {\r\n            var obj = JSON.parse(xhr.responseText);\r\n            // This is to supress an error that happens with team archive/unarchive\r\n            var errorMessage = obj.error.message;\r\n            if (errorMessage.startswith == \"No Team found with Group id\") {\r\n                // do nothing - supress error\r\n            }\r\n            else {\r\n                throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            }\r\n            //console.log(\"MSTeamsConnector ExecuteRequest: Failed with 404 error.\");\r\n            //throw new Error(obj.error.code + \" error: \" + obj.error.message);\r\n            //console.log(\"Failed with status \" + xhr.status + \" \" + xhr.responseText);\r\n        }\r\n        else {\r\n            postResult({\r\n                //TeamIsSuccessful: false\r\n            });\r\n            var obj = JSON.parse(xhr.responseText);\r\n            throw new Error(obj.error.code + \": \" + obj.error.message);\r\n            //console.log(\"Failed with status \" + xhr.status + \" \" + xhr.responseText);\r\n\r\n        }\r\n    };\r\n    console.log(\"MSTeamsConnector ExecuteRequest: \" + url);\r\n    xhr.open(requestType.toUpperCase(), url);\r\n    // Authentication Header\r\n    xhr.withCredentials = true;\r\n    xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n    if (requestType.toUpperCase() == \"PUT\" || requestType.toUpperCase() == \"POST\" || requestType.toUpperCase() == \"PATCH\") {\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    }\r\n    xhr.send(data);\r\n}\r\n\r\n\r\nfunction onexecuteSearchFile(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetDriveFile(parameters, properties, function (a) {\r\n        var resultObj = {\r\n            [FileId]: \"\",\r\n            [FileWebUrl]: \"\",\r\n            [FileSize]: 0,\r\n            [FileName]: \"\",\r\n            [FileCreated]: null,\r\n            [FileCreatedBy]: \"\",\r\n            [FileCreatedByEmail]: \"\",\r\n            [FileMimeType]: \"\"\r\n        };\r\n\r\n        if (a.value.length > 0) {\r\n            resultObj[FileId] = a.value[0].id;\r\n            resultObj[FileWebUrl] = a.value[0].webUrl;\r\n            resultObj[FileSize] = a.value[0].size;\r\n            resultObj[FileName] = a.value[0].name;\r\n            resultObj[FileCreated] = Date.parse(a.value[0].createdDateTime);\r\n            resultObj[FileCreatedBy] = a.value[0].createdBy.user.displayName;\r\n            resultObj[FileCreatedByEmail] = a.value[0].createdBy.user.email;\r\n            resultObj[FileMimeType] = a.value[0].file.mimeType;\r\n        }\r\n\r\n        postResult(resultObj);\r\n    });\r\n}\r\n\r\nfunction GetDriveFile(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileName = properties[FileName];\r\n    let filePath = properties[FilePath];\r\n    if (!(typeof fileName === \"string\")) throw new Error(\"properties[FileName] is not of type string\");\r\n\r\n    var url;\r\n    if ((typeof filePath === \"string\") && (filePath != \"\")) {\r\n        url = baseUriEndpoint + `/me/drive/root:/${filePath}:/search(q='${fileName}')`;\r\n    }\r\n    else {\r\n        url = baseUriEndpoint + `/me/drive/root/search(q='${fileName}')`;\r\n    }\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteCreateFolder(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreateDriveFolder(parameters, properties, function () {\r\n        //postResult({});\r\n    });\r\n}\r\n\r\nfunction CreateDriveFolder(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let folderName = properties[FolderName];\r\n    let folderPath = properties[FolderPath];\r\n\r\n    if (!(typeof folderName === \"string\")) throw new Error(\"properties[FolderName] is not of type string\");\r\n\r\n    var url;\r\n    if ((typeof folderPath === \"string\") && (folderPath != \"\")) {\r\n        url = baseUriEndpoint + `/me/drive/root:/${folderPath}:/children'`;\r\n    }\r\n    else {\r\n        url = baseUriEndpoint + `/me/drive/root/children`;\r\n    }\r\n\r\n    var data = {\r\n        \"name\": folderName,\r\n        \"folder\": {},\r\n        \"@microsoft.graph.conflictBehavior\": \"replace\"\r\n    };\r\n\r\n    ExecuteRequest(url, JSON.stringify(data), \"POST\", function () {\r\n        if (typeof cb === 'function')\r\n            cb();\r\n    });\r\n}\r\n\r\nfunction onexecuteGetRangeItems(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetItemsByRange(parameters, properties, function (a) {\r\n        var obj = a.values.map(x => {\r\n            var obj = {};\r\n\r\n            for (var i = 0; i < x.length; i++) {\r\n                if ((i + 1) < 21) {\r\n                    obj[\"column\" + (i + 1)] = x[i];\r\n                }\r\n            }\r\n            return obj;\r\n        });\r\n\r\n        postResult(obj);\r\n    });\r\n}\r\n\r\nfunction GetItemsByRange(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n    let sheetName = properties[ExcelSheetName];\r\n    let range = properties[WorksheetRange];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n    if (!(typeof sheetName === \"string\")) throw new Error(\"properties[ExcelSheetName] is not of type string\");\r\n    if (!(typeof range === \"string\")) throw new Error(\"properties[WorksheetRange] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets/${sheetName}/range(address='${range}')`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction GetItemsByRangeRow(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n    let sheetName = properties[ExcelSheetName];\r\n    let range = properties[WorksheetRange];\r\n    let index = properties[RowCount];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n    if (!(typeof sheetName === \"string\")) throw new Error(\"properties[ExcelSheetName] is not of type string\");\r\n    if (!(typeof range === \"string\")) throw new Error(\"properties[WorksheetRange] is not of type string\");\r\n    if ((typeof index === \"string\") || index < 0) throw new Error(\"properties[RowCount] is not correct\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets/${sheetName}/range(address='${range}')/visibleView/rows/itemAt(index=${index})`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetRangeRow(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetItemsByRangeRow(parameters, properties, function (a) {\r\n        var obj = {};\r\n\r\n        if (a.values.length > 0) {\r\n            for (var i = 0; i < a.values[0].length; i++) {\r\n                if ((i + 1) < 21) {\r\n                    obj[\"column\" + (i + 1)] = a.values[0][i];\r\n                }\r\n            }\r\n        }\r\n\r\n        postResult(obj);\r\n    });\r\n}\r\n\r\nfunction GetItemsByUsedRangeRow(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n    let sheetName = properties[ExcelSheetName];\r\n    let index = properties[RowCount];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n    if (!(typeof sheetName === \"string\")) throw new Error(\"properties[ExcelSheetName] is not of type string\");\r\n    if ((typeof index === \"string\") || index < 0) throw new Error(\"properties[RowCount] is not correct\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets/${sheetName}/usedRange/visibleView/rows/itemAt(index=${index})`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetUsedRangeRow(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetItemsByUsedRangeRow(parameters, properties, function (a) {\r\n        var obj = {};\r\n\r\n        if (a.values.length > 0) {\r\n            for (var i = 0; i < a.values[0].length; i++) {\r\n                if ((i + 1) < 21) {\r\n                    obj[\"column\" + (i + 1)] = a.values[0][i];\r\n                }\r\n            }\r\n        }\r\n\r\n        postResult(obj);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetCell(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetCellValue(parameters, properties, function (a) {\r\n        postResult({\r\n            [CellValue]: a.values[0][0]\r\n        });\r\n    });\r\n}\r\n\r\nfunction GetCellValue(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n    let sheetName = properties[ExcelSheetName];\r\n    let range = properties[WorksheetRange];\r\n    let rowCount = properties[RowCount];\r\n    let columnCount = properties[ColumnCount];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n    if (!(typeof sheetName === \"string\")) throw new Error(\"properties[ExcelSheetName] is not of type string\");\r\n    if (!(typeof range === \"string\")) throw new Error(\"properties[WorksheetRange] is not of type string\");\r\n    if (!(typeof rowCount === \"number\")) throw new Error(\"properties[RowCount] is not of type integer\");\r\n    if (!(typeof columnCount === \"number\")) throw new Error(\"properties[ColumnCount] is not of type integer\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets/${sheetName}/range(address='${range}')/cell(row=${rowCount},column=${columnCount})`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetUsedRange(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUsedRangeItems(parameters, properties, function (a) {\r\n        postResult({\r\n            [WorksheetRange]: a.address.split(\"!\")[1]\r\n        });\r\n    });\r\n}\r\n\r\nfunction onexecuteUsedRange(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUsedRangeItems(parameters, properties, function (a) {\r\n        var obj = a.values.map(x => {\r\n            var obj = {};\r\n\r\n            for (var i = 0; i < x.length; i++) {\r\n                if ((i + 1) < 21) {\r\n                    obj[\"column\" + (i + 1)] = x[i];\r\n                }\r\n            }\r\n            return obj;\r\n        });\r\n\r\n        postResult(obj);\r\n    });\r\n}\r\n\r\nfunction GetUsedRangeItems(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n    let sheetName = properties[ExcelSheetName];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n    if (!(typeof sheetName === \"string\")) throw new Error(\"properties[ExcelSheetName] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets('${sheetName}')/usedRange`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetUsedRangeColumnNames(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetUsedRangeItems(parameters, properties, function (a) {\r\n\r\n        var count = 0;\r\n        var objArr = [];\r\n\r\n        if (a.text.length > 0) {\r\n            count = a.text[0].length;\r\n\r\n            for (var i = 1; i < count + 1; i++) {\r\n                objArr.push({\r\n                    [ColumnName]: i\r\n                });\r\n            }\r\n        }\r\n\r\n        postResult(objArr);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetRangeColumnNames(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetItemsByRange(parameters, properties, function (a) {\r\n\r\n        var count = 0;\r\n        var objArr = [];\r\n\r\n        if (a.text.length > 0) {\r\n            count = a.text[0].length;\r\n\r\n            for (var i = 1; i < count + 1; i++) {\r\n                objArr.push({\r\n                    [ColumnName]: i\r\n                });\r\n            }\r\n        }\r\n\r\n        postResult(objArr);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetWorksheets(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetWorksheets(parameters, properties, function (a) {\r\n        var obj = a.value.map(x => {\r\n            return {\r\n                [WorksheetId]: x.id,\r\n                [WorksheetName]: x.name,\r\n                [WorksheetPosition]: x.position,\r\n                [WorksheetVisibility]: x.visibility\r\n            };\r\n        });\r\n\r\n        postResult(obj);\r\n    });\r\n}\r\n\r\nfunction GetWorksheets(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let fileId = properties[FileId];\r\n\r\n    if (!(typeof fileId === \"string\")) throw new Error(\"properties[FileId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/me/drive/items/${fileId}/workbook/worksheets`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetGroups(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetGroupItems(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [GroupId]: x.id,\r\n                [GroupName]: x.displayName,\r\n                [GroupDescription]: x.description,\r\n                [GroupMail]: x.mail,\r\n                [GroupVisibility]: x.visibility\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction GetGroupItems(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    var url = baseUriEndpoint + '/groups';\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteCreatePlan(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreatePlannerPlan(parameters, properties, function (a) {\r\n        postResult({\r\n            [PlanId]: a.id\r\n        });\r\n    });\r\n}\r\n\r\nfunction CreatePlannerPlan(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let planTitle = properties[PlanTitle];\r\n    let planGroup = properties[PlanOwnerGroup];\r\n\r\n    if (!(typeof planTitle === \"string\")) throw new Error(\"properties[PlanTitle] is not of type string\");\r\n    if (!(typeof planGroup === \"string\")) throw new Error(\"properties[PlanOwnerGroup] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + '/planner/plans';\r\n\r\n    var data = {\r\n        title: planTitle,\r\n        owner: planGroup\r\n    };\r\n\r\n    ExecuteRequest(url, JSON.stringify(data), \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteCreateBucket(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreatePlannerPlanBucket(parameters, properties, function (a) {\r\n        postResult({\r\n            [BucketId]: a.id\r\n        });\r\n    });\r\n}\r\n\r\nfunction CreatePlannerPlanBucket(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let bucketName = properties[BucketName];\r\n    let planId = properties[PlanId];\r\n\r\n    if (!(typeof bucketName === \"string\")) throw new Error(\"properties[BucketName] is not of type string\");\r\n    if (!(typeof planId === \"string\")) throw new Error(\"properties[PlanId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + '/planner/buckets';\r\n\r\n    var data = {\r\n        name: bucketName,\r\n        planId: planId\r\n    };\r\n\r\n    ExecuteRequest(url, JSON.stringify(data), \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteCreateGroup(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreateNewGroup(parameters, properties, function (a) {\r\n        postResult({\r\n            [GroupId]: a.id,\r\n            [GroupName]: a.displayName,\r\n            [GroupDescription]: a.description,\r\n            [GroupMail]: a.mail,\r\n            [GroupVisibility]: a.visibility\r\n        });\r\n    });\r\n}\r\n\r\nfunction CreateNewGroup(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let groupName = properties[GroupName];\r\n    let groupDesc = properties[GroupDescription];\r\n    let groupVisibility = properties[GroupVisibility];\r\n    let groupMailEnabled = properties[GroupMailEnabled];\r\n    let groupMailNic = properties[GroupMailNickname];\r\n    let groupSecurityEnabled = properties[GroupSecurityEnabled];\r\n    let groupOwnerId = properties[GroupOwnerId];\r\n\r\n\r\n    if (!(typeof groupName === \"string\")) throw new Error(\"properties[GroupName] is not of type string\");\r\n    if (!(typeof groupMailNic === \"string\")) throw new Error(\"properties[GroupMailNickname] is not of type string\");\r\n    if (!(typeof groupOwnerId === \"string\")) throw new Error(\"properties[GroupOwnerId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + '/groups';\r\n\r\n    var data = {\r\n        displayName: groupName,\r\n        mailEnabled: groupMailEnabled,\r\n        mailNickname: groupMailNic,\r\n        securityEnabled: groupSecurityEnabled,\r\n        description: groupDesc,\r\n        visibility: (groupVisibility != null && groupVisibility != \"\") ? groupVisibility : \"Public\",\r\n        groupTypes: [\"Unified\"],\r\n        \"owners@odata.bind\": [\r\n            `https://graph.microsoft.com/v1.0/users/${groupOwnerId}`\r\n        ]\r\n    };\r\n\r\n    ExecuteRequest(url, JSON.stringify(data), \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetUser(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetGroupUserByEmail(parameters, properties, function (a) {\r\n        postResult({\r\n            [UserId]: a.id,\r\n            [UserDisplayName]: a.displayName,\r\n            [UserEmail]: a.mail,\r\n            [UserGivenName]: a.givenName,\r\n            [UserLastName]: a.surname,\r\n            [UserJobTitle]: a.jobTitle\r\n        });\r\n    });\r\n}\r\n\r\nfunction GetGroupUserByEmail(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let userMail = properties[UserEmail];\r\n\r\n    if (!(typeof userMail === \"string\")) throw new Error(\"properties[UserEmail] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/users/${userMail}`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteAddUserToGroup(parameters: SingleRecord, properties: SingleRecord) {\r\n    AddUser(parameters, properties, function (a) {\r\n        postResult({});\r\n    });\r\n}\r\n\r\nfunction AddUser(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let groupId = properties[GroupId];\r\n    let userId = properties[UserId];\r\n\r\n    if (!(typeof groupId === \"string\")) throw new Error(\"properties[GroupId] is not of type string\");\r\n    if (!(typeof userId === \"string\")) throw new Error(\"properties[UserId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/groups/${groupId}/members/$ref`;\r\n\r\n    var data = {\r\n        \"@odata.id\": `https://graph.microsoft.com/v1.0/directoryObjects/${userId}`\r\n    };\r\n\r\n    ExecuteRequest(url, JSON.stringify(data), \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetPlans(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetPlans(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [PlanId]: x.id,\r\n                [PlanTitle]: x.title\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction GetPlans(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let groupId = properties[PlanOwnerGroup];\r\n\r\n    if (!(typeof groupId === \"string\")) throw new Error(\"properties[PlanOwnerGroup] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/groups/${groupId}/planner/plans`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteGetBuckets(parameters: SingleRecord, properties: SingleRecord) {\r\n    GetBuckets(parameters, properties, function (a) {\r\n        postResult(a.value.map(x => {\r\n            return {\r\n                [BucketId]: x.id,\r\n                [BucketName]: x.name\r\n            };\r\n        }));\r\n    });\r\n}\r\n\r\nfunction GetBuckets(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let planId = properties[PlanId];\r\n\r\n    if (!(typeof planId === \"string\")) throw new Error(\"properties[PlanId] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + `/planner/plans/${planId}/buckets`;\r\n\r\n    ExecuteRequest(url, null, \"GET\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}\r\n\r\nfunction onexecuteCreateTask(parameters: SingleRecord, properties: SingleRecord) {\r\n    CreatePlanTask(parameters, properties, function (a) {\r\n        postResult({\r\n            [TaskId]: a.id\r\n        });\r\n    });\r\n}\r\n\r\nfunction CreatePlanTask(parameters: SingleRecord, properties: SingleRecord, cb) {\r\n    let planId = properties[PlanId];\r\n    let taskUserId = properties[TaskUserId];\r\n    let taskTitle = properties[TaskTitle];\r\n    let taskDueDate = properties[TaskDueDate] != null && properties[TaskDueDate] != \"\" ? properties[TaskDueDate].toString() : \"\";\r\n    let bucketId = properties[BucketId];\r\n\r\n    if (taskDueDate != \"\") {\r\n        taskDueDate = new Date(taskDueDate).toISOString().split(\"T\")[0];\r\n    }\r\n\r\n    if (!(typeof planId === \"string\")) throw new Error(\"properties[PlanId] is not of type string\");\r\n    if (!(typeof taskUserId === \"string\")) throw new Error(\"properties[TaskUserId] is not of type string\");\r\n    if (!(typeof taskTitle === \"string\")) throw new Error(\"properties[TaskTitle] is not of type string\");\r\n\r\n    var url = baseUriEndpoint + '/planner/tasks';\r\n\r\n    var data = `{\\\"planId\\\":\\\"${planId}\\\",\\\"title\\\":\\\"${taskTitle}\\\",\\\"dueDateTime\\\":\\\"${taskDueDate}\\\",\\\"bucketId\\\":\\\"${bucketId}\\\",\\\"assignments\\\":{\\\"${taskUserId}\\\":{\\\"@odata.type\\\":\\\"#microsoft.graph.plannerAssignment\\\",\\\"orderHint\\\":\\\" !\\\"}}}`;\r\n\r\n    ExecuteRequest(url, data, \"POST\", function (responseText) {\r\n        if (typeof cb === 'function')\r\n            cb(responseText);\r\n    });\r\n}"],"names":["metadata","systemName","displayName","description","baseUriEndpoint","FileId","PlanId","ExecuteRequest","url","data","requestType","cb","xhr","XMLHttpRequest","onreadystatechange","console","log","status","responseText","readyState","obj","JSON","parse","e","Error","error","code","message","postResult","startswith","open","toUpperCase","withCredentials","setRequestHeader","send","GetItemsByRange","parameters","properties","fileId","sheetName","range","GetUsedRangeItems","ondescribe","postSchema","objects","type","methods","inputs","requiredInputs","outputs","onexecute","objectName","methodName","fileName","filePath","GetDriveFile","a","resultObj","value","length","id","webUrl","size","name","Date","createdDateTime","createdBy","user","email","file","mimeType","onexecuteSearchFile","folderName","folderPath","stringify","CreateDriveFolder","onexecuteCreateFolder","onexecuteDrive","address","split","onexecuteGetUsedRange","values","map","x","i","onexecuteUsedRange","count","objArr","text","push","onexecuteGetUsedRangeColumnNames","onexecuteGetRangeColumnNames","GetWorksheets","position","visibility","onexecuteGetWorksheets","onexecuteGetRangeItems","rowCount","columnCount","GetCellValue","onexecuteGetCell","index","GetItemsByUsedRangeRow","onexecuteGetUsedRangeRow","GetItemsByRangeRow","onexecuteGetRangeRow","onexecuteExcel","mail","groupName","groupDesc","groupVisibility","groupMailEnabled","groupMailNic","groupSecurityEnabled","groupOwnerId","mailEnabled","mailNickname","securityEnabled","groupTypes","CreateNewGroup","onexecuteCreateGroup","groupId","userId","AddUser","onexecuteAddUserToGroup","onexecuteGroup","planTitle","planGroup","title","owner","CreatePlannerPlan","onexecuteCreatePlan","bucketName","planId","CreatePlannerPlanBucket","onexecuteCreateBucket","GetPlans","onexecuteGetPlans","GetBuckets","onexecuteGetBuckets","taskUserId","taskTitle","taskDueDate","toString","bucketId","toISOString","CreatePlanTask","onexecuteCreateTask","onexecutePlanner","userMail","GetGroupUserByEmail","givenName","surname","jobTitle","onexecuteGetUser","onexecuteUser"],"mappings":"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"}